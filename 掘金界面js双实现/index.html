<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="./index.css">
  <title>Document</title>
</head>
<body>
  <div class="index-view">
    <div class="alerts">
      已经收藏了强大的css
    </div>
    <div class="uesr-info" style="display:none;">
      <div class="user-img">
        <img src="http://wx.qlogo.cn/mmopen/qKWLW7BIlaMZFJnEZJf31ZyLPfb1v0YqrHRfr8c325n9EzCDfMRqwDWZZMoWdhibpmlibd1ibJyicTIely1DLGkvY0IWaCvicichtK/0" alt="">
      </div>
      <p>最凉不过人心，最丑不过人性</p>
      <div class="user-des">
        <div class="user-detail user-read">
          <p class="read-number">585</p>
          <p class="read">阅读</p>
        </div>
        <div class="user-detail user-collect">
          <p class="read-number">6</p>
          <p class="read">收藏</p>
        </div>
      </div>
    </div>
    <div class="main">
      <div class="entry-detail">
        <div class="entry-detail-main-area">
          <i class="ion-ios-close-outline entry-close"></i>
          <div class="entry-detail-container">
            <div class="entry-detail-header background-cover" style="background-image: none;">
              <div class="entry-box">
                <div class="title-box clearfix">
                  <a href="#" class="title">强大的 CSS</a>
                </div>
                <div class="action-box clearfix">
                  <a href="#" class="button blue original-url-button">阅读原文</a>
                  <button class="entry-collection-button">
                    <i class="collection-arrow-ion ion-arrow-up-b"></i>
                    <span>64</span>
                  </button>
                </div>
              </div>
            </div>

            <div class="entry-detail-body flex">
              <div class="entry-detail-left action">
                <div class="editor">
                  <img class="avatar" src="http://tva3.sinaimg.cn/crop.0.0.1241.1241.180/92633ca2jw8f3bnx444ffj20yi0yhn17.jpg">
                  <div class="editor-meta clearfix">
                    <span class="user-name text-a">小晨欧尼酱</span>
                    <span class="user-job-title"></span>
                    <div class="entry-meta-info">20小时前发布·786人阅读</div>
                  </div>
                  <div class="editor-content">
                    <article>只需要 CSS 不借助 JS 也可以做很多复杂的事情，但是有限制是只适配现代浏览器。</article>
                  </div>
                </div>
                <div class="comment-box">
                  <div class="new-comment new-comment-card">
                    <img src="http://wx.qlogo.cn/mmopen/qKWLW7BIlaMZFJnEZJf31ZyLPfb1v0YqrHRfr8c325n9EzCDfMRqwDWZZMoWdhibpmlibd1ibJyicTIely1DLGkvY0IWaCvicichtK/0" alt="" class="avatar">
                    <textarea class="new-comment-input" placeholder="说说你的看法"></textarea>
                    <div class="comment-actions" style="display:none">
                      <div class="actions secondary">
                        <div class="action comment-tips">Ctrl or ⌘ + Enter</div>
                        <div class="action">
                          <button>评论</button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <ul class="comments">

                  <li class="comment">
                    <img src="http://wx.qlogo.cn/mmopen/BO1qQiajiacVmOm4ic0iaJhsHO5sTLEGdPauGibAZJ9HX0mCJodicwdgQRXvCwrNVNbygLJQ5h7a1bl639jbXYNicaw9iceAtFgnLXYg/0" class="avatar">
                    <div class="comment-user-meta">
                      <span class="user-name text-a">旅梦</span>
                      <span class="user-job-title"></span>
                    </div>
                    <div class="comment-content">赞</div>
                    <div class="comment-meta">
                      <div class="comment-like-box action">
                        <i class="ion-arrow-up-b like-icon"></i>
                        <span class="like-count">2</span>
                      </div>
                      <div class="reply action">回复</div>
                      <div class="action">1小时前</div>
                    </div>
                  </li>
                  <li class="comment">
                    <img src="http://wx.qlogo.cn/mmopen/BO1qQiajiacVmOm4ic0iaJhsHO5sTLEGdPauGibAZJ9HX0mCJodicwdgQRXvCwrNVNbygLJQ5h7a1bl639jbXYNicaw9iceAtFgnLXYg/0" class="avatar">
                    <div class="comment-user-meta">
                      <span class="user-name text-a">旅梦</span>
                      <span class="user-job-title"></span>
                    </div>
                    <div class="comment-content">赞</div>
                    <div class="comment-meta">
                      <div class="comment-like-box action">
                        <i class="ion-arrow-up-b like-icon"></i>
                        <span class="like-count">10</span>
                      </div>
                      <div class="reply action">回复</div>
                      <div class="action">1小时前</div>
                    </div>
                  </li>
                  <li class="comment">
                    <img src="http://wx.qlogo.cn/mmopen/BO1qQiajiacVmOm4ic0iaJhsHO5sTLEGdPauGibAZJ9HX0mCJodicwdgQRXvCwrNVNbygLJQ5h7a1bl639jbXYNicaw9iceAtFgnLXYg/0" class="avatar">
                    <div class="comment-user-meta">
                      <span class="user-name text-a">旅梦</span>
                      <span class="user-job-title"></span>
                    </div>
                    <div class="comment-content">赞</div>
                    <div class="comment-meta">
                      <div class="comment-like-box action">
                        <i class="ion-arrow-up-b like-icon"></i>
                        <span class="like-count">1</span>
                      </div>
                      <div class="reply action">回复</div>
                      <div class="action">1小时前</div>
                    </div>
                  </li>
                </ul>
              </div>

              <div class="entry-detail-right">
                <div class="share-box">
                  <div class="sub-title">分享到...</div>
                  <div class="tags cloud">
                    <a href="#" class="tag">
                      <img src="http://gold.xitu.io/images/weixin.svg" alt="" class="inline">
                      <span>微信</span>
                    </a>
                    <a href="#" class="tag">
                      <img src="http://gold.xitu.io/images/weibo.svg" alt="" class="inline">
                      <span>微博</span>
                    </a>
                    <a href="#" class="tag">
                      <img src="http://gold.xitu.io/images/pocket.svg" alt="" class="inline">
                      <span>Pocket</span>
                    </a>
                    <a href="#" class="tag">
                      <img src="http://gold.xitu.io/images/evernote.svg" alt="" class="inline">
                      <span>Evernote</span>
                    </a>
                  </div>
                </div>
                <div class="tags-box">
                  <div class="sub-title">标签</div>
                  <div class="tags cloud">
                    <div class="tag">CSS</div>
                  </div>
                </div>
                <div class="collection-users">
                  <div class="sub-title">64 人收藏了这篇文章</div>
                  <ul class="users-list">
                    <li class="users-list-item">
                      <img src="http://wx.qlogo.cn/mmopen/qKWLW7BIlaMZFJnEZJf31ZyLPfb1v0YqrHRfr8c325n9EzCDfMRqwDWZZMoWdhibpmlibd1ibJyicTIely1DLGkvY0IWaCvicichtK/0" class="avatar">
                    </li>
                    <li class="users-list-item">
                      <img src="http://tva4.sinaimg.cn/crop.0.0.640.640.180/4c41eac1jw8eqbaw3nzffj20hs0hst98.jpg" class="avatar">
                    </li>
                    <li class="users-list-item">
                      <img src="http://tva4.sinaimg.cn/crop.0.0.640.640.180/4c41eac1jw8eqbaw3nzffj20hs0hst98.jpg" class="avatar">
                    </li>
                    <li class="users-list-item">
                      <img src="http://tva4.sinaimg.cn/crop.0.0.640.640.180/4c41eac1jw8eqbaw3nzffj20hs0hst98.jpg" class="avatar">
                    </li>
                    <li class="users-list-item">
                      <img src="http://tva4.sinaimg.cn/crop.0.0.640.640.180/4c41eac1jw8eqbaw3nzffj20hs0hst98.jpg" class="avatar">
                    </li>
                    <li class="users-list-item">
                      <img src="http://tva4.sinaimg.cn/crop.0.0.640.640.180/4c41eac1jw8eqbaw3nzffj20hs0hst98.jpg" class="avatar">
                    </li>
                    <li class="users-list-item">
                      <img src="http://tva4.sinaimg.cn/crop.0.0.640.640.180/4c41eac1jw8eqbaw3nzffj20hs0hst98.jpg" class="avatar">
                    </li>
                    <li class="users-list-item">
                      <img src="http://tva4.sinaimg.cn/crop.0.0.640.640.180/4c41eac1jw8eqbaw3nzffj20hs0hst98.jpg" class="avatar">
                    </li>
                    <li class="users-list-item">
                      <img src="http://tva4.sinaimg.cn/crop.0.0.640.640.180/4c41eac1jw8eqbaw3nzffj20hs0hst98.jpg" class="avatar">
                    </li>
                    <li class="users-list-item">
                      <img src="http://tva4.sinaimg.cn/crop.0.0.640.640.180/4c41eac1jw8eqbaw3nzffj20hs0hst98.jpg" class="avatar">
                    </li>
                    <li class="users-list-item">
                      <img src="http://tva4.sinaimg.cn/crop.0.0.640.640.180/4c41eac1jw8eqbaw3nzffj20hs0hst98.jpg" class="avatar">
                    </li>
                    <li class="users-list-item">
                      <img src="http://tva4.sinaimg.cn/crop.0.0.640.640.180/4c41eac1jw8eqbaw3nzffj20hs0hst98.jpg" class="avatar">
                    </li>
                    <li class="users-list-item">
                      <img src="http://tva4.sinaimg.cn/crop.0.0.640.640.180/4c41eac1jw8eqbaw3nzffj20hs0hst98.jpg" class="avatar">
                    </li>
                    <li class="users-list-item">
                      <div class="more-users">
                        <i class="ion-more"></i>
                      </div>
                    </li>
                  </ul>
                </div>
                <div class="recommend-box">
                  <div class="sub-title">相关热门文章</div>
                  <ul class="entry-list">
                    <li class="entry-item">
                      <div class="item-title text-a ellipsis">Flex 布局新旧混合写法详解（兼容微信）</div>
                      <div class="item-collection inline-nav">
                        <div class="action">
                          <i class="ion-arrow-up-b"></i>
                          <span class="collection-count">28</span>
                        </div>
                        <div class="action">gebin</div>
                      </div>
                    </li>
                    <li class="entry-item">
                      <div class="item-title text-a ellipsis">css Table 布局 - display:table</div>
                      <div class="item-collection inline-nav">
                        <div class="action">
                          <i class="ion-arrow-up-b"></i>
                          <span class="collection-count">14</span>
                        </div>
                        <div class="action">愚人码头</div>
                      </div>
                    </li>
                    <li class="entry-item">
                      <div class="item-title text-a ellipsis">Edge 浏览器插件开发方法详解</div>
                      <div class="item-collection inline-nav">
                        <div class="action">
                          <i class="ion-arrow-up-b"></i>
                          <span class="collection-count">7</span>
                        </div>
                        <div class="action">码蛋</div>
                      </div>
                    </li>
                    <li class="entry-item">
                      <div class="item-title text-a ellipsis">通过 Babel 使用 ES6 的 import</div>
                      <div class="item-collection inline-nav">
                        <div class="action">
                          <i class="ion-arrow-up-b"></i>
                          <span class="collection-count">4</span>
                        </div>
                        <div class="action">凹凸实验室</div>
                      </div>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
<script src="http://cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script>
  $(function() {
    $('.comments').on('click','.comment-like-box',function(){//点赞
      var n = $.trim($(this).text());
      console.log(n);
      if(!$(".comment-like-box").hasClass("true")) {
        n++;
        $(this).find('span').text(n);
        $(".comment-like-box").addClass("true");
      }
      else {
        n--;
        $(this).find('span').text(n);
        $(".comment-like-box").removeClass("true");
      }
    });
    $(".new-comment-input").focus(function() {
      $(".comment-actions").show();
    });
    $(".new-comment-input").blur(function() { //移除焦点
      setTimeout(function(){
        $(".comment-actions").hide();
      },1000);
    });
    $(".action button").click(function() { //点击发布
        var val = $.trim($(".new-comment-input").val());
        console.log(val);
        var sr = "http://wx.qlogo.cn/mmopen/BO1qQiajiacVmOm4ic0iaJhsHO5sTLEGdPauGibAZJ9HX0mCJodicwdgQRXvCwrNVNbygLJQ5h7a1bl639jbXYNicaw9iceAtFgnLXYg/0"
        if( val != ''){
          $('<li class="comment"><img src="'+sr+'" class="avatar"><div class="comment-user-meta"><span class="user-name text-a">蒋正洲</span><span class="user-job-title"></span></div><div class="comment-content">'+val+'</div><div class="comment-meta"><div class="comment-like-box action"><i class="ion-arrow-up-b like-icon"></i><span class="like-count">1</span></div><div class="reply action">回复</div><div class="action">刚刚</div></div></li>').insertBefore(".comments .comment:first-child");
          $('.new-comment-input').val('');
        }
    });
    $(".more-users").click(function(){
      $.getJSON("/data.json",{},function(data){
        // console.log(data[0].src);
        // console.log(data.length);
        for( var i=0; i<data.length; i++) {
          $('<li class="users-list-item"><img src="'+data[i].src+'" class="avatar"></li>').insertBefore(".users-list-item:last-child");
        }
      })
    });
    function parseUrlQueryParams(url) {
      var obj = {};
      var queryStr = url.split("?")[1];
      var queryArr = queryStr.split("&");
      // console.log(queryArr);
      // console.log(queryArr.length);
      for(var i=0; i<queryArr.length; i++) {
        var arr = queryArr[i].split("=");
        var name = arr[0];
        var value = arr[1];
        obj[name] = value;
      }
      return obj;
      // console.log(obj);
    };

    $(".ion-ios-close-outline.entry-close").click(function() {
      // var strHref = window.location.href;
      // alert(strHref);
      // window.location.href = "http://gold.xitu.io/";
      // window.location.reload();
      var str = "http://www.baidu.com?id=123&num=6";
      var params = parseUrlQueryParams(str);
      console.log(params.id);
    });
    //获取点击按钮
    //判断是否收藏，否
    $(".entry-collection-button").click(function() {
      if ($(this).hasClass("collected")) { //若有类名collected
        cancleCollect(); //取消收藏
      } else {
        setCollect(); //添加收藏
      }
    });
    function cancleCollect() {
      decreaseCollectNum();
    };
    function setCollect() {
      increseCollectNum();
      //从屏幕的右侧往左弹出一个收藏的提示 几秒后隐藏
      $(".alerts").animate({right:"15px"});
      setTimeout(function(){
        $(".alerts").animate({right:"-120px"});
      },1000);
      collectSuccessToast();
      upDateCollectAvatars();

    };
    function increseCollectNum(){
      $(".entry-collection-button").addClass("collected");
      //按钮上数字增加一
      var number = $(".entry-collection-button span").text();//获取上面的64
      number++;
      $(".entry-collection-button span").text(number);
    };
    function decreaseCollectNum(){
      //判断为收藏后，点击则为取消收藏
      $(".entry-collection-button.collected").removeClass("collected");//删除类名collected
      //两个数字减1
      var number = $(".entry-collection-button span").text();//获取上面的64
      number--;
      $(".entry-collection-button span").text(number);

      var numbers = parseInt($(".collection-users .sub-title").text());//获取下面的64
      numbers--;
      $(".collection-users .sub-title").text(numbers + " 人收藏了这篇文章");
      //移除头像
      $(".users-list .users-list-item:first-child").remove();
    };
    function collectSuccessToast(){
      //收藏人数数量增加1
      var numbers = parseInt($(".collection-users .sub-title").text());//获取下面的64
      numbers++;
      $(".collection-users .sub-title").text(numbers + " 人收藏了这篇文章");
    };
    function upDateCollectAvatars(){
      //更新头像的数量
      //添加一个头像到最前面
      insertUserAvatar();
    };
    function insertUserAvatar(){
      var src = "http://wx.qlogo.cn/mmopen/qKWLW7BIlaMZFJnEZJf31TfV9EledLpu4LfdcIZPzyibr78YuJflSJkWI5wiaTVbZpcxMwyLmfGiaPPmhFemkjf6woTjgjX8ThP/0"
      $('<li class="users-list-item"><img class="avatar" src="'+src+'" alt="" /></li>').insertBefore(".users-list .users-list-item:first-child");
    };
  });
</script>
</body>
</html>
